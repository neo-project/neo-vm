{
    "category": "Arrays",
    "name": "SETITEM",
    "tests":
    [
        {
            "name": "Map in key",
            "script": "0x51C700C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xA8D0D989428ACC4D0871A63867FB65C090D4C192",
                                "instructionPointer": 3,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    },
                                    {
                                        "type": "Map",
                                        "value":
                                        {
                                        }
                                    },
                                    {
                                        "type": "Integer",
                                        "value": 1
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Fault",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xA8D0D989428ACC4D0871A63867FB65C090D4C192",
                                "instructionPointer": 3,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 1
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Without array",
            "script": "0x000000C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x0F72B9DC4389FB6D2FAC8F9954FF4174748F39BF",
                                "instructionPointer": 3,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    },
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    },
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Fault",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x0F72B9DC4389FB6D2FAC8F9954FF4174748F39BF",
                                "instructionPointer": 3,
                                "nextInstruction": "SETITEM"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Without push",
            "script": "0xC4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Fault",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x72BB72F41041A6D0E9AB5BB6F67EC3AF7BF6FA5F",
                                "instructionPointer": 0,
                                "nextInstruction": "SETITEM"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Out of bounds [Array]",
            "script": "0x51C55155C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xD553A5EA4F28980DF7A29E353A776972D7699B3D",
                                "instructionPointer": 4,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    },
                                    {
                                        "type": "Integer",
                                        "value": 1
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Fault",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xD553A5EA4F28980DF7A29E353A776972D7699B3D",
                                "instructionPointer": 4,
                                "nextInstruction": "SETITEM"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Out of bounds [Struct]",
            "script": "0x51C65155C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x4FABD5803C205E3DB0BEEF56D39C3940796BA4CF",
                                "instructionPointer": 4,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    },
                                    {
                                        "type": "Integer",
                                        "value": 1
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Fault",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x4FABD5803C205E3DB0BEEF56D39C3940796BA4CF",
                                "instructionPointer": 4,
                                "nextInstruction": "SETITEM"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Real test [Array]",
            "script": "0x51C5760055C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x877385686FE501BFA80B0715C5CD7FA957E4A7ED",
                                "instructionPointer": 5,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    },
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x877385686FE501BFA80B0715C5CD7FA957E4A7ED",
                                "instructionPointer": 6,
                                "nextInstruction": "RET",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Halt",
                        "resultStack":
                        [
                            {
                                "type": "Array",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Real test [Struct]",
            "script": "0x51C6760055C4",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xC10661B57C68864B7994373CDE871EC54203004B",
                                "instructionPointer": 5,
                                "nextInstruction": "SETITEM",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    },
                                    {
                                        "type": "ByteArray",
                                        "value": ""
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0xC10661B57C68864B7994373CDE871EC54203004B",
                                "instructionPointer": 6,
                                "nextInstruction": "RET",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Halt",
                        "resultStack":
                        [
                            {
                                "type": "Struct",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 5
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Clone test [Array]",
            "script": "0x51C5760055C46B6A760054C46C",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x2869989D59157DA2EF25E1752AC9B0D3F195F4AA",
                                "instructionPointer": 3,
                                "nextInstruction": "PUSH0",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x2869989D59157DA2EF25E1752AC9B0D3F195F4AA",
                                "instructionPointer": 6,
                                "nextInstruction": "TOALTSTACK",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x2869989D59157DA2EF25E1752AC9B0D3F195F4AA",
                                "instructionPointer": 9,
                                "nextInstruction": "PUSH0",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ],
                                "altStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x2869989D59157DA2EF25E1752AC9B0D3F195F4AA",
                                "instructionPointer": 12,
                                "nextInstruction": "FROMALTSTACK",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ],
                                "altStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x2869989D59157DA2EF25E1752AC9B0D3F195F4AA",
                                "instructionPointer": 13,
                                "nextInstruction": "RET",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Array",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Halt",
                        "resultStack":
                        [
                            {
                                "type": "Array",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 4
                                    }
                                ]
                            },
                            {
                                "type": "Array",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 4
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        },
        {
            "name": "Clone test [Struct]",
            "script": "0x51C6760055C46B6A760054C46C",
            "steps":
            [
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x716E9E24FE0569FD7F7D9CD36AF55629E523F1BC",
                                "instructionPointer": 3,
                                "nextInstruction": "PUSH0",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Boolean",
                                                "value": false
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x716E9E24FE0569FD7F7D9CD36AF55629E523F1BC",
                                "instructionPointer": 6,
                                "nextInstruction": "TOALTSTACK",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x716E9E24FE0569FD7F7D9CD36AF55629E523F1BC",
                                "instructionPointer": 9,
                                "nextInstruction": "PUSH0",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ],
                                "altStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 5
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto",
                        "StepInto",
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x716E9E24FE0569FD7F7D9CD36AF55629E523F1BC",
                                "instructionPointer": 12,
                                "nextInstruction": "FROMALTSTACK",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ],
                                "altStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Break",
                        "invocationStack":
                        [
                            {
                                "scriptHash": "0x716E9E24FE0569FD7F7D9CD36AF55629E523F1BC",
                                "instructionPointer": 13,
                                "nextInstruction": "RET",
                                "evaluationStack":
                                [
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    },
                                    {
                                        "type": "Struct",
                                        "value":
                                        [
                                            {
                                                "type": "Integer",
                                                "value": 4
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "actions":
                    [
                        "StepInto"
                    ],
                    "result":
                    {
                        "state": "Halt",
                        "resultStack":
                        [
                            {
                                "type": "Struct",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 4
                                    }
                                ]
                            },
                            {
                                "type": "Struct",
                                "value":
                                [
                                    {
                                        "type": "Integer",
                                        "value": 4
                                    }
                                ]
                            }
                        ]
                    }
                }
            ]
        }
    ]
}